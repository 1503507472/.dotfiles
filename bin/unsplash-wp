#!/bin/sh

# Simple script's pulling given $UNSPLASH_COLLECTION to a directory defined by $UNSPLASH_DIR.
# You need to add export your $UNSPLASH_TOKEN before use it
mkdir -p $UNSPLASH_DIR

URLS=`curl -s -H "Authorization: Client-ID $UNSPLASH_TOKEN" https://api.unsplash.com/collections/$UNSPLASH_COLLECTION/photos\?per_page\=30 | jq ".[] | .urls.full"`
for URL in $URLS; do
  if [[ $URL =~ \/(photo.*)\? ]]; then
    NAME="${UNSPLASH_DIR}${BASH_REMATCH[1]}.jpg";
    if test -f $NAME; then
      echo "File Exists: ${NAME}"
    else
      curl -s `sed -e 's/^"//' -e 's/"$//' <<< "$URL"` -o $NAME
      echo "Downloading: ${NAME}"
    fi
  fi
done;
echo 'done'
